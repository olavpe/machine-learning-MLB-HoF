<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-07-02 Fri 01:14 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Extracting from Lahman's Raw Data</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Olav Pedersen" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/js/readtheorg.js"></script>
<style> #content{max-width:1800px;}</style>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="content">
<h1 class="title">Extracting from Lahman's Raw Data</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgd412fed">1. Activating Python Environment</a></li>
<li><a href="#org8aac0f8">2. Importing dependencies</a></li>
<li><a href="#org0a84f4d">3. Importing Raw Data</a></li>
<li><a href="#org5856435">4. Cleaning and Joining the Different Datasets</a>
<ul>
<li><a href="#org3c77b04">4.1. Batting Data</a></li>
<li><a href="#org08a8325">4.2. Awards Data</a></li>
<li><a href="#org7bbabc5">4.3. All-Start Data</a></li>
<li><a href="#orgff4024b">4.4. Hall of Fame Data</a></li>
<li><a href="#org1119883">4.5. Player Data</a></li>
<li><a href="#orgafdfb83">4.6. Appearance Data</a></li>
</ul>
</li>
<li><a href="#org92b55ff">5. Joining and Saving the Datasets</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgd412fed" class="outline-2">
<h2 id="orgd412fed"><span class="section-number-2">1</span> Activating Python Environment</h2>
<div class="outline-text-2" id="text-1">
<p>
This code block must be run to activate python virtual environment for
org session "SESSION_1". The following Python code blocks are run in
"SESSION_1" in which the virtual environment should have been activated.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5e7e9b;">(</span>pyvenv-activate <span style="color: #5a7273;">"~/gitRepos/TTK28-project/venv/"</span><span style="color: #5e7e9b;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org8aac0f8" class="outline-2">
<h2 id="org8aac0f8"><span class="section-number-2">2</span> Importing dependencies</h2>
<div class="outline-text-2" id="text-2">
<p>
This project only uses <code>pandas</code> and built in python functions for data manipulation.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #5e7e9b; font-weight: bold;">import</span> pandas <span style="color: #5e7e9b; font-weight: bold;">as</span> pd
</pre>
</div>
</div>
</div>

<div id="outline-container-org0a84f4d" class="outline-2">
<h2 id="org0a84f4d"><span class="section-number-2">3</span> Importing Raw Data</h2>
<div class="outline-text-2" id="text-3">
<p>
Importing the datasets from the raw Sean Lahman's Baseball Database, from
those files that contain relevant data for determining MLB Hall of Fame Players.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #7e97af;">master_df</span> = pd.read_csv<span style="color: #5e7e9b;">(</span><span style="color: #5a7273;">'../data/core/People.csv'</span>,
                        usecols=<span style="color: #bf6c68;">[</span><span style="color: #5a7273;">'playerID'</span>,<span style="color: #5a7273;">'nameFirst'</span>,<span style="color: #5a7273;">'nameLast'</span>,<span style="color: #5a7273;">'bats'</span>,<span style="color: #5a7273;">'throws'</span>,<span style="color: #5a7273;">'debut'</span>,<span style="color: #5a7273;">'finalGame'</span><span style="color: #bf6c68;">]</span><span style="color: #5e7e9b;">)</span>
<span style="color: #7e97af;">batting_df</span> = pd.read_csv<span style="color: #5e7e9b;">(</span><span style="color: #5a7273;">'../data/core/Batting.csv'</span><span style="color: #5e7e9b;">)</span>
<span style="color: #7e97af;">awards_df</span> = pd.read_csv<span style="color: #5e7e9b;">(</span><span style="color: #5a7273;">'../data/core/AwardsPlayers.csv'</span>,
                        usecols=<span style="color: #bf6c68;">[</span><span style="color: #5a7273;">'playerID'</span>,<span style="color: #5a7273;">'awardID'</span>,<span style="color: #5a7273;">'yearID'</span><span style="color: #bf6c68;">]</span><span style="color: #5e7e9b;">)</span>
<span style="color: #7e97af;">allstar_df</span> = pd.read_csv<span style="color: #5e7e9b;">(</span><span style="color: #5a7273;">'../data/core/AllstarFull.csv'</span>,
                         usecols=<span style="color: #bf6c68;">[</span><span style="color: #5a7273;">'playerID'</span>,<span style="color: #5a7273;">'yearID'</span><span style="color: #bf6c68;">]</span><span style="color: #5e7e9b;">)</span>
<span style="color: #7e97af;">hof_df</span> = pd.read_csv<span style="color: #5e7e9b;">(</span><span style="color: #5a7273;">'../data/core/HallOfFame.csv'</span>,
                     usecols=<span style="color: #bf6c68;">[</span><span style="color: #5a7273;">'playerID'</span>,<span style="color: #5a7273;">'yearID'</span>,<span style="color: #5a7273;">'votedBy'</span>,<span style="color: #5a7273;">'needed_note'</span>,<span style="color: #5a7273;">'inducted'</span>,<span style="color: #5a7273;">'category'</span><span style="color: #bf6c68;">]</span><span style="color: #5e7e9b;">)</span>
<span style="color: #7e97af;">appearances_df</span> = pd.read_csv<span style="color: #5e7e9b;">(</span><span style="color: #5a7273;">'../data/core/Appearances.csv'</span><span style="color: #5e7e9b;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org5856435" class="outline-2">
<h2 id="org5856435"><span class="section-number-2">4</span> Cleaning and Joining the Different Datasets</h2>
<div class="outline-text-2" id="text-4">
<p>
Since data is spread over several files and is stored differently in the
different files, the following sub sections attempt at extracting the relevant
information and aggreating it for each player.
</p>
</div>

<div id="outline-container-org3c77b04" class="outline-3">
<h3 id="org3c77b04"><span class="section-number-3">4.1</span> Batting Data</h3>
<div class="outline-text-3" id="text-4-1">
<p>
This adds the batting stats for the different players. The <code>player_stats</code>
dictionary is where the player information is aggregated until setting it to
the <code>master_df</code>.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #7e97af;">player_stats</span> = <span style="color: #5e7e9b;">{}</span> <span style="color: #48485e;">#</span><span style="color: #48485e;">key: playerID  value: player stats</span>
<span style="color: #7e97af;">years_played</span> = <span style="color: #5e7e9b;">{}</span> <span style="color: #48485e;">#</span><span style="color: #48485e;">key: playerID  value: yearID</span>

<span style="color: #5e7e9b; font-weight: bold;">for</span> i, row <span style="color: #5e7e9b; font-weight: bold;">in</span> batting_df.iterrows<span style="color: #5e7e9b;">()</span>:
    <span style="color: #7e97af;">playerID</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'playerID'</span><span style="color: #5e7e9b;">]</span>
    <span style="color: #5e7e9b; font-weight: bold;">if</span> playerID <span style="color: #5e7e9b; font-weight: bold;">in</span> player_stats:
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G'</span><span style="color: #5e7e9b;">]</span> = player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G'</span><span style="color: #5e7e9b;">]</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'AB'</span><span style="color: #5e7e9b;">]</span> = player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'AB'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'AB'</span><span style="color: #5e7e9b;">]</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'R'</span><span style="color: #5e7e9b;">]</span> = player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'R'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'R'</span><span style="color: #5e7e9b;">]</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'H'</span><span style="color: #5e7e9b;">]</span> = player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'H'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'H'</span><span style="color: #5e7e9b;">]</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'2B'</span><span style="color: #5e7e9b;">]</span> = player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'2B'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'2B'</span><span style="color: #5e7e9b;">]</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'3B'</span><span style="color: #5e7e9b;">]</span> = player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'3B'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'3B'</span><span style="color: #5e7e9b;">]</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'HR'</span><span style="color: #5e7e9b;">]</span> = player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'HR'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'HR'</span><span style="color: #5e7e9b;">]</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'RBI'</span><span style="color: #5e7e9b;">]</span> = player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'RBI'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'RBI'</span><span style="color: #5e7e9b;">]</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'SB'</span><span style="color: #5e7e9b;">]</span> = player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'SB'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'SB'</span><span style="color: #5e7e9b;">]</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'BB'</span><span style="color: #5e7e9b;">]</span> = player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'BB'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'BB'</span><span style="color: #5e7e9b;">]</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'SO'</span><span style="color: #5e7e9b;">]</span> = player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'SO'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'SO'</span><span style="color: #5e7e9b;">]</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'IBB'</span><span style="color: #5e7e9b;">]</span> = player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'IBB'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'IBB'</span><span style="color: #5e7e9b;">]</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'HBP'</span><span style="color: #5e7e9b;">]</span> = player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'HBP'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'HBP'</span><span style="color: #5e7e9b;">]</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'SH'</span><span style="color: #5e7e9b;">]</span> = player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'SH'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'SH'</span><span style="color: #5e7e9b;">]</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'SF'</span><span style="color: #5e7e9b;">]</span> = player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'SF'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'SF'</span><span style="color: #5e7e9b;">]</span>
        years_played<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">]</span>.append<span style="color: #5e7e9b;">(</span>row<span style="color: #bf6c68;">[</span><span style="color: #5a7273;">'yearID'</span><span style="color: #bf6c68;">]</span><span style="color: #5e7e9b;">)</span>
    <span style="color: #5e7e9b; font-weight: bold;">else</span>:
        <span style="color: #7e97af;">player_stats</span><span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">]</span> = <span style="color: #5e7e9b;">{}</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G'</span><span style="color: #5e7e9b;">]</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'AB'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'AB'</span><span style="color: #5e7e9b;">]</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'R'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'R'</span><span style="color: #5e7e9b;">]</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'H'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'H'</span><span style="color: #5e7e9b;">]</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'2B'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'2B'</span><span style="color: #5e7e9b;">]</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'3B'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'3B'</span><span style="color: #5e7e9b;">]</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'HR'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'HR'</span><span style="color: #5e7e9b;">]</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'RBI'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'RBI'</span><span style="color: #5e7e9b;">]</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'SB'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'SB'</span><span style="color: #5e7e9b;">]</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'BB'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'BB'</span><span style="color: #5e7e9b;">]</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'SO'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'SO'</span><span style="color: #5e7e9b;">]</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'IBB'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'IBB'</span><span style="color: #5e7e9b;">]</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'HBP'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'HBP'</span><span style="color: #5e7e9b;">]</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'SH'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'SH'</span><span style="color: #5e7e9b;">]</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'SF'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'SF'</span><span style="color: #5e7e9b;">]</span>
        <span style="color: #7e97af;">years_played</span><span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">]</span> = <span style="color: #5e7e9b;">[]</span>
        years_played<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">]</span>.append<span style="color: #5e7e9b;">(</span>row<span style="color: #bf6c68;">[</span><span style="color: #5a7273;">'yearID'</span><span style="color: #bf6c68;">]</span><span style="color: #5e7e9b;">)</span>


<span style="color: #48485e;"># </span><span style="color: #48485e;">add number of years_played data into the player_stats dictionary</span>
<span style="color: #5e7e9b; font-weight: bold;">for</span> k,v <span style="color: #5e7e9b; font-weight: bold;">in</span> years_played.items<span style="color: #5e7e9b;">()</span>:
    player_stats<span style="color: #5e7e9b;">[</span>k<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'Years_Played'</span><span style="color: #5e7e9b;">]</span> = <span style="color: #5e7e9b;">len</span><span style="color: #5e7e9b;">(</span><span style="color: #5e7e9b;">list</span><span style="color: #bf6c68;">(</span><span style="color: #5e7e9b;">set</span><span style="color: #5a7273;">(</span>v<span style="color: #5a7273;">)</span><span style="color: #bf6c68;">)</span><span style="color: #5e7e9b;">)</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org08a8325" class="outline-3">
<h3 id="org08a8325"><span class="section-number-3">4.2</span> Awards Data</h3>
<div class="outline-text-3" id="text-4-2">
<p>
Selecting 5 of the <code>awardID</code> to be used as features.
</p>

<div class="org-src-container">
<pre class="src src-python">awards_df<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'awardID'</span><span style="color: #5e7e9b;">]</span>.unique<span style="color: #5e7e9b;">()</span>
<span style="color: #7e97af;">mvp</span> = awards_df<span style="color: #5e7e9b;">[</span>awards_df<span style="color: #bf6c68;">[</span><span style="color: #5a7273;">'awardID'</span><span style="color: #bf6c68;">]</span> == <span style="color: #5a7273;">'Most Valuable Player'</span><span style="color: #5e7e9b;">]</span>
<span style="color: #7e97af;">roy</span> = awards_df<span style="color: #5e7e9b;">[</span>awards_df<span style="color: #bf6c68;">[</span><span style="color: #5a7273;">'awardID'</span><span style="color: #bf6c68;">]</span> == <span style="color: #5a7273;">'Rookie of the Year'</span><span style="color: #5e7e9b;">]</span>
<span style="color: #7e97af;">gg</span> = awards_df<span style="color: #5e7e9b;">[</span>awards_df<span style="color: #bf6c68;">[</span><span style="color: #5a7273;">'awardID'</span><span style="color: #bf6c68;">]</span> == <span style="color: #5a7273;">'Gold Glove'</span><span style="color: #5e7e9b;">]</span>
<span style="color: #7e97af;">ss</span> = awards_df<span style="color: #5e7e9b;">[</span>awards_df<span style="color: #bf6c68;">[</span><span style="color: #5a7273;">'awardID'</span><span style="color: #bf6c68;">]</span> == <span style="color: #5a7273;">'Silver Slugger'</span><span style="color: #5e7e9b;">]</span>
<span style="color: #7e97af;">ws_mvp</span> = awards_df<span style="color: #5e7e9b;">[</span>awards_df<span style="color: #bf6c68;">[</span><span style="color: #5a7273;">'awardID'</span><span style="color: #bf6c68;">]</span> == <span style="color: #5a7273;">'World Series MVP'</span><span style="color: #5e7e9b;">]</span>
<span style="color: #7e97af;">awards_list</span> = <span style="color: #5e7e9b;">[</span>mvp,roy,gg,ss,ws_mvp<span style="color: #5e7e9b;">]</span>

<span style="color: #7e97af;">mvp_list</span> = <span style="color: #5e7e9b;">[]</span>
<span style="color: #7e97af;">roy_list</span> = <span style="color: #5e7e9b;">[]</span>
<span style="color: #7e97af;">gg_list</span> = <span style="color: #5e7e9b;">[]</span>
<span style="color: #7e97af;">ss_list</span> = <span style="color: #5e7e9b;">[]</span>
<span style="color: #7e97af;">ws_mvp_list</span> = <span style="color: #5e7e9b;">[]</span>
<span style="color: #7e97af;">lists</span> = <span style="color: #5e7e9b;">[</span>mvp_list,roy_list,gg_list,ss_list,ws_mvp_list<span style="color: #5e7e9b;">]</span>

<span style="color: #48485e;"># </span><span style="color: #48485e;">add awards count for each player in player_stats</span>
<span style="color: #5e7e9b; font-weight: bold;">for</span> index,v <span style="color: #5e7e9b; font-weight: bold;">in</span> <span style="color: #5e7e9b;">enumerate</span><span style="color: #5e7e9b;">(</span>awards_list<span style="color: #5e7e9b;">)</span>:
    <span style="color: #5e7e9b; font-weight: bold;">for</span> i,row <span style="color: #5e7e9b; font-weight: bold;">in</span> v.iterrows<span style="color: #5e7e9b;">()</span>:
        <span style="color: #7e97af;">playerID</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'playerID'</span><span style="color: #5e7e9b;">]</span>
        <span style="color: #7e97af;">award</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'awardID'</span><span style="color: #5e7e9b;">]</span>

        <span style="color: #5e7e9b; font-weight: bold;">if</span> playerID <span style="color: #5e7e9b; font-weight: bold;">in</span> player_stats <span style="color: #5e7e9b; font-weight: bold;">and</span> playerID <span style="color: #5e7e9b; font-weight: bold;">in</span> lists<span style="color: #5e7e9b;">[</span>index<span style="color: #5e7e9b;">]</span>:
            player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span>award<span style="color: #5e7e9b;">]</span> += <span style="color: #cb8986;">1</span>
        <span style="color: #5e7e9b; font-weight: bold;">else</span>:
            lists<span style="color: #5e7e9b;">[</span>index<span style="color: #5e7e9b;">]</span>.append<span style="color: #5e7e9b;">(</span>playerID<span style="color: #5e7e9b;">)</span>
            player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span>award<span style="color: #5e7e9b;">]</span> = <span style="color: #cb8986;">1</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org7bbabc5" class="outline-3">
<h3 id="org7bbabc5"><span class="section-number-3">4.3</span> All-Start Data</h3>
<div class="outline-text-3" id="text-4-3">
<p>
Add a count of appearances in All-Star game for players in <code>player_stats</code>.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #7e97af;">allstar_list</span> = <span style="color: #5e7e9b;">[]</span>

<span style="color: #5e7e9b; font-weight: bold;">for</span> i,row <span style="color: #5e7e9b; font-weight: bold;">in</span> allstar_df.iterrows<span style="color: #5e7e9b;">()</span>:
    <span style="color: #7e97af;">playerID</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'playerID'</span><span style="color: #5e7e9b;">]</span>
    <span style="color: #5e7e9b; font-weight: bold;">if</span> playerID <span style="color: #5e7e9b; font-weight: bold;">in</span> player_stats <span style="color: #5e7e9b; font-weight: bold;">and</span> playerID <span style="color: #5e7e9b; font-weight: bold;">in</span> allstar_list:
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'AS_games'</span><span style="color: #5e7e9b;">]</span> += <span style="color: #cb8986;">1</span>
    <span style="color: #5e7e9b; font-weight: bold;">else</span>:
        allstar_list.append<span style="color: #5e7e9b;">(</span>playerID<span style="color: #5e7e9b;">)</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'AS_games'</span><span style="color: #5e7e9b;">]</span> = <span style="color: #cb8986;">1</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgff4024b" class="outline-3">
<h3 id="orgff4024b"><span class="section-number-3">4.4</span> Hall of Fame Data</h3>
<div class="outline-text-3" id="text-4-4">
<p>
Adding Hall of Fame information to <code>master_df</code>.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #7e97af;">hof_df</span> = hof_df<span style="color: #5e7e9b;">[</span><span style="color: #bf6c68;">(</span>hof_df<span style="color: #5a7273;">[</span><span style="color: #5a7273;">'inducted'</span><span style="color: #5a7273;">]</span> == <span style="color: #5a7273;">'Y'</span><span style="color: #bf6c68;">)</span> &amp; <span style="color: #bf6c68;">(</span>hof_df<span style="color: #5a7273;">[</span><span style="color: #5a7273;">'category'</span><span style="color: #5a7273;">]</span> == <span style="color: #5a7273;">'Player'</span><span style="color: #bf6c68;">)</span><span style="color: #5e7e9b;">]</span>

<span style="color: #5e7e9b; font-weight: bold;">for</span> i,row <span style="color: #5e7e9b; font-weight: bold;">in</span> hof_df.iterrows<span style="color: #5e7e9b;">()</span>:
    <span style="color: #7e97af;">playerID</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'playerID'</span><span style="color: #5e7e9b;">]</span>
    <span style="color: #5e7e9b; font-weight: bold;">if</span> playerID <span style="color: #5e7e9b; font-weight: bold;">in</span> player_stats:
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'HoF'</span><span style="color: #5e7e9b;">]</span> = <span style="color: #cb8986;">1</span>
        player_stats<span style="color: #5e7e9b;">[</span>playerID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'votedBy'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'votedBy'</span><span style="color: #5e7e9b;">]</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org1119883" class="outline-3">
<h3 id="org1119883"><span class="section-number-3">4.5</span> Player Data</h3>
<div class="outline-text-3" id="text-4-5">
<p>
Until now, I have collected data from batting_df, fielding_df, awards_df,
allstar_df, and hof_df into the player_stats dictionary. Then, I will
convert it to a dataframe stats_df.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #7e97af;">stats_df</span> = pd.DataFrame.from_dict<span style="color: #5e7e9b;">(</span>player_stats,orient=<span style="color: #5a7273;">'index'</span><span style="color: #5e7e9b;">)</span>

<span style="color: #48485e;"># </span><span style="color: #48485e;">join stats_df with master_df on index playerID</span>
<span style="color: #7e97af;">stats_df</span><span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'playerID'</span><span style="color: #5e7e9b;">]</span> = stats_df.index
<span style="color: #7e97af;">master_df</span> = master_df.join<span style="color: #5e7e9b;">(</span>stats_df, on=<span style="color: #5a7273;">'playerID'</span>, how=<span style="color: #5a7273;">'inner'</span>,
                           rsuffix=<span style="color: #5a7273;">'mstr'</span><span style="color: #5e7e9b;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgafdfb83" class="outline-3">
<h3 id="orgafdfb83"><span class="section-number-3">4.6</span> Appearance Data</h3>
<div class="outline-text-3" id="text-4-6">
<p>
Aggregating information about appearances at each position for players for
different years.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #7e97af;">pos_dict</span> = <span style="color: #5e7e9b;">{}</span>

<span style="color: #5e7e9b; font-weight: bold;">for</span> i,row <span style="color: #5e7e9b; font-weight: bold;">in</span> appearances_df.iterrows<span style="color: #5e7e9b;">()</span>:
    <span style="color: #7e97af;">ID</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'playerID'</span><span style="color: #5e7e9b;">]</span>
    <span style="color: #7e97af;">year</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'yearID'</span><span style="color: #5e7e9b;">]</span>
    <span style="color: #5e7e9b; font-weight: bold;">if</span> ID <span style="color: #5e7e9b; font-weight: bold;">in</span> pos_dict:
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_all'</span><span style="color: #5e7e9b;">]</span> = pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_all'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_all'</span><span style="color: #5e7e9b;">]</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_p'</span><span style="color: #5e7e9b;">]</span> = pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_p'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_p'</span><span style="color: #5e7e9b;">]</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_c'</span><span style="color: #5e7e9b;">]</span> = pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_c'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_c'</span><span style="color: #5e7e9b;">]</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_1b'</span><span style="color: #5e7e9b;">]</span> = pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_1b'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_1b'</span><span style="color: #5e7e9b;">]</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_2b'</span><span style="color: #5e7e9b;">]</span> = pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_2b'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_2b'</span><span style="color: #5e7e9b;">]</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_3b'</span><span style="color: #5e7e9b;">]</span> = pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_3b'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_3b'</span><span style="color: #5e7e9b;">]</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_ss'</span><span style="color: #5e7e9b;">]</span> = pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_ss'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_ss'</span><span style="color: #5e7e9b;">]</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_lf'</span><span style="color: #5e7e9b;">]</span> = pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_lf'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_lf'</span><span style="color: #5e7e9b;">]</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_cf'</span><span style="color: #5e7e9b;">]</span> = pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_cf'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_cf'</span><span style="color: #5e7e9b;">]</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_rf'</span><span style="color: #5e7e9b;">]</span> = pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_rf'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_rf'</span><span style="color: #5e7e9b;">]</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_of'</span><span style="color: #5e7e9b;">]</span> = pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_of'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_of'</span><span style="color: #5e7e9b;">]</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_dh'</span><span style="color: #5e7e9b;">]</span> = pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_dh'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_dh'</span><span style="color: #5e7e9b;">]</span>

        <span style="color: #5e7e9b; font-weight: bold;">if</span> year &lt; <span style="color: #cb8986;">1920</span>:
            pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'pre1920'</span><span style="color: #5e7e9b;">]</span> = pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'pre1920'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_all'</span><span style="color: #5e7e9b;">]</span>
        <span style="color: #5e7e9b; font-weight: bold;">elif</span> year &gt;= <span style="color: #cb8986;">1920</span> <span style="color: #5e7e9b; font-weight: bold;">and</span> year &lt;= <span style="color: #cb8986;">1941</span>:
            pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'1920-41'</span><span style="color: #5e7e9b;">]</span> = pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'1920-41'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_all'</span><span style="color: #5e7e9b;">]</span>
        <span style="color: #5e7e9b; font-weight: bold;">elif</span> year &gt;= <span style="color: #cb8986;">1942</span> <span style="color: #5e7e9b; font-weight: bold;">and</span> year &lt;= <span style="color: #cb8986;">1945</span>:
            pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'1942-45'</span><span style="color: #5e7e9b;">]</span> = pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'1942-45'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_all'</span><span style="color: #5e7e9b;">]</span>
        <span style="color: #5e7e9b; font-weight: bold;">elif</span> year &gt;= <span style="color: #cb8986;">1946</span> <span style="color: #5e7e9b; font-weight: bold;">and</span> year &lt;= <span style="color: #cb8986;">1962</span>:
            pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'1946-62'</span><span style="color: #5e7e9b;">]</span> = pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'1946-62'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_all'</span><span style="color: #5e7e9b;">]</span>
        <span style="color: #5e7e9b; font-weight: bold;">elif</span> year &gt;= <span style="color: #cb8986;">1963</span> <span style="color: #5e7e9b; font-weight: bold;">and</span> year &lt;= <span style="color: #cb8986;">1976</span>:
            pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'1963-76'</span><span style="color: #5e7e9b;">]</span> = pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'1963-76'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_all'</span><span style="color: #5e7e9b;">]</span>
        <span style="color: #5e7e9b; font-weight: bold;">elif</span> year &gt;= <span style="color: #cb8986;">1977</span> <span style="color: #5e7e9b; font-weight: bold;">and</span> year &lt;= <span style="color: #cb8986;">1992</span>:
            pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'1977-92'</span><span style="color: #5e7e9b;">]</span> = pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'1977-92'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_all'</span><span style="color: #5e7e9b;">]</span>
        <span style="color: #5e7e9b; font-weight: bold;">elif</span> year &gt;= <span style="color: #cb8986;">1993</span> <span style="color: #5e7e9b; font-weight: bold;">and</span> year &lt;= <span style="color: #cb8986;">2009</span>:
            pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'1993-2009'</span><span style="color: #5e7e9b;">]</span> = pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'1993-2009'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_all'</span><span style="color: #5e7e9b;">]</span>
        <span style="color: #5e7e9b; font-weight: bold;">elif</span> year &gt; <span style="color: #cb8986;">2009</span>:
            pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'post2009'</span><span style="color: #5e7e9b;">]</span> = pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'post2009'</span><span style="color: #5e7e9b;">]</span> + row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_all'</span><span style="color: #5e7e9b;">]</span>
    <span style="color: #5e7e9b; font-weight: bold;">else</span>:
        <span style="color: #7e97af;">pos_dict</span><span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">]</span> = <span style="color: #5e7e9b;">{}</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_all'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_all'</span><span style="color: #5e7e9b;">]</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_p'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_p'</span><span style="color: #5e7e9b;">]</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_c'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_c'</span><span style="color: #5e7e9b;">]</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_1b'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_1b'</span><span style="color: #5e7e9b;">]</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_2b'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_2b'</span><span style="color: #5e7e9b;">]</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_3b'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_3b'</span><span style="color: #5e7e9b;">]</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_ss'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_ss'</span><span style="color: #5e7e9b;">]</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_lf'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_lf'</span><span style="color: #5e7e9b;">]</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_cf'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_cf'</span><span style="color: #5e7e9b;">]</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_rf'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_rf'</span><span style="color: #5e7e9b;">]</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_of'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_of'</span><span style="color: #5e7e9b;">]</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'G_dh'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_dh'</span><span style="color: #5e7e9b;">]</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'pre1920'</span><span style="color: #5e7e9b;">]</span> = <span style="color: #cb8986;">0</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'1920-41'</span><span style="color: #5e7e9b;">]</span> = <span style="color: #cb8986;">0</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'1942-45'</span><span style="color: #5e7e9b;">]</span> = <span style="color: #cb8986;">0</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'1946-62'</span><span style="color: #5e7e9b;">]</span> = <span style="color: #cb8986;">0</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'1963-76'</span><span style="color: #5e7e9b;">]</span> = <span style="color: #cb8986;">0</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'1977-92'</span><span style="color: #5e7e9b;">]</span> = <span style="color: #cb8986;">0</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'1993-2009'</span><span style="color: #5e7e9b;">]</span> = <span style="color: #cb8986;">0</span>
        pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'post2009'</span><span style="color: #5e7e9b;">]</span> = <span style="color: #cb8986;">0</span>

        <span style="color: #5e7e9b; font-weight: bold;">if</span> year &lt; <span style="color: #cb8986;">1920</span>:
            pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'pre1920'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_all'</span><span style="color: #5e7e9b;">]</span>
        <span style="color: #5e7e9b; font-weight: bold;">elif</span> year &gt;= <span style="color: #cb8986;">1920</span> <span style="color: #5e7e9b; font-weight: bold;">and</span> year &lt;= <span style="color: #cb8986;">1941</span>:
            pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'1920-41'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_all'</span><span style="color: #5e7e9b;">]</span>
        <span style="color: #5e7e9b; font-weight: bold;">elif</span> year &gt;= <span style="color: #cb8986;">1942</span> <span style="color: #5e7e9b; font-weight: bold;">and</span> year &lt;= <span style="color: #cb8986;">1945</span>:
            pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'1942-45'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_all'</span><span style="color: #5e7e9b;">]</span>
        <span style="color: #5e7e9b; font-weight: bold;">elif</span> year &gt;= <span style="color: #cb8986;">1946</span> <span style="color: #5e7e9b; font-weight: bold;">and</span> year &lt;= <span style="color: #cb8986;">1962</span>:
            pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'1946-62'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_all'</span><span style="color: #5e7e9b;">]</span>
        <span style="color: #5e7e9b; font-weight: bold;">elif</span> year &gt;= <span style="color: #cb8986;">1963</span> <span style="color: #5e7e9b; font-weight: bold;">and</span> year &lt;= <span style="color: #cb8986;">1976</span>:
            pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'1963-76'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_all'</span><span style="color: #5e7e9b;">]</span>
        <span style="color: #5e7e9b; font-weight: bold;">elif</span> year &gt;= <span style="color: #cb8986;">1977</span> <span style="color: #5e7e9b; font-weight: bold;">and</span> year &lt;= <span style="color: #cb8986;">1992</span>:
            pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'1977-92'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_all'</span><span style="color: #5e7e9b;">]</span>
        <span style="color: #5e7e9b; font-weight: bold;">elif</span> year &gt;= <span style="color: #cb8986;">1993</span> <span style="color: #5e7e9b; font-weight: bold;">and</span> year &lt;= <span style="color: #cb8986;">2009</span>:
            pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'1993-2009'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_all'</span><span style="color: #5e7e9b;">]</span>
        <span style="color: #5e7e9b; font-weight: bold;">elif</span> year &gt; <span style="color: #cb8986;">2009</span>:
            pos_dict<span style="color: #5e7e9b;">[</span>ID<span style="color: #5e7e9b;">][</span><span style="color: #5a7273;">'post2009'</span><span style="color: #5e7e9b;">]</span> = row<span style="color: #5e7e9b;">[</span><span style="color: #5a7273;">'G_all'</span><span style="color: #5e7e9b;">]</span>

<span style="color: #7e97af;">pos_df</span> = pd.DataFrame.from_dict<span style="color: #5e7e9b;">(</span>pos_dict,orient=<span style="color: #5a7273;">'index'</span><span style="color: #5e7e9b;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org92b55ff" class="outline-2">
<h2 id="org92b55ff"><span class="section-number-2">5</span> Joining and Saving the Datasets</h2>
<div class="outline-text-2" id="text-5">
<p>
Simply adding appearance data to the <code>master_df</code>.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #48485e;">## </span><span style="color: #48485e;">join pos_df and master_df</span>
<span style="color: #7e97af;">master_df</span> = master_df.join<span style="color: #5e7e9b;">(</span>pos_df,on=<span style="color: #5a7273;">'playerID'</span>,how=<span style="color: #5a7273;">'right'</span><span style="color: #5e7e9b;">)</span>
master_df.to_csv<span style="color: #5e7e9b;">(</span><span style="color: #5a7273;">'../data/final_data.csv'</span><span style="color: #5e7e9b;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Olav Pedersen</p>
<p class="date">Created: 2021-07-02 Fri 01:14</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
